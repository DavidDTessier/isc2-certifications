![Domain 6](images/domain6.png)

## 6.1 Articulate legal requirements and unique risks within the cloud environment

Conflicting International Legislation
* important to be aware of the various laws and regulations that govern cloud computing
* laws can introduce risks to a business, such as fines, penalities, or even a loss of the ability to do business in a certain place
* important to identify suchs risks and make recommendations to mitigate them just like any other risk
* Example Conflict with GDPR and CLOUD Act:
    * GDPR forbids the transfer of data to countries that lack adequate privacy protections
    * Clarifying Lawful Overseas Use of Data (CLOUD) Act requires CSPs to hand over data to aid in investigation of serious crimes, even if stored in another country
    * compliance requires collaboration
    * legal counsel should be part of the evaluation of any cloud-specific risks, legal requests, and the company's response to these
* Encryption and Privacy
    * **Compute Export Controls**
        * US companies can't export to Cuba, Iran, North Korea, Sudan, and Syria
    * **Encryption Export Controls**
        * Dept of Commerce details limitations on export of encryption productions outside of the US
    * **Privacy (US)**
        * basis for privacy rights is in the Fourth Amendment to the US Constitution
    * **Privacy (EU)**
        * General Data Protection Regulation (GDPR) is not a US law, but very likely to be mentioned
        * applies to any company with customers in the EU!
* Laws and Regs and the risks introduce
    * **Copyright and Intellectual property law**
        * particularly the jurisdictions that companies need to deal with (local versus international) to protect and enforce their IP protections
    * **Safeguards and security controls required for privacy compliance**
        * particularly details of data residency or the ability to move data between countries, as well as varying requirements of due care in different jurisdictions
    * **Data breaches**
        * and their aftermath, particularly breach notificaiton
    * **International import/export laws**
        * particularly technologies that may be sensitive or illegal under various international agreements

Differences between laws, regulation, standards, and frameworks
    * **Laws**
        * legal rules
        * created by government entities
        * MUST be followed
    * **Regulations**
        * rules that are created by government agencies
        * MUST be followed
    * **Standards**
        * dictate a reasonable level of performance
        * can be created by an organization for its own purposes(internal) or come from industry bodies or trade groups (external)
    * **Frameworks**
        * are a set of guidelines helping organizations improve their security posture

Types of Law
* **Criminal Law**
    * contains prohibitions against acts such as murder, assault, robbery, and arson
* **Cival Law**
    * include contract disputes, real estate transactions, employment matters, and estate/probate procedures
    * vendor contracts fall into this category
* **Administrative Law**
    * policies, procedures, and regulations that govern the daily operations of government and government agencies
    * HIPAA falls into this category
* **Contitutional Law**
    * highest possible source of law in the US
    * no laws from other sources may conflict with the provisions of the US Constitution
    * Contains seven articles
        * **Artical I** 
            * establishes the legislative branch
        * **Artical II**
            * establishes the executive branch
        * **Artical III**
            * establishes the judicial branch
        * **Artical IV**
            * defines the relationship between the federal government and state governments
        * **Artical V** 
            * cretes a process for amending the Constitution itself
        * **Article VI**
            * contains the supremacy clauses, establishing that the Constitution is the supreme law of the land
        * **Artical VII**
            * sets forth the process for the initial establishment of the federal government
* **Case Law**
    * interpretations made by courts over time establish a body of law that other courts may refer to when making their own decisions
* **Common Law**
    * set of judicial precedants passwed down as case law through many generations
    * an stand as examples in future court cases
* **Contract Law**
    * violations, "breach of contract", of a contract generally do not involve law enforcement agencies, so they are treated as private disputes between parties and handled in civil court
* **Torts Law**
    * form of civil violation that do not involve a contract but instead, involve harm to one party caused by the acitons of another party
    * **Negligence**
        * _commonly occurring tort that occurs when one party causes harm to another by their action or lack of action_
    * there must be a **duty of care**, the person accused of negligence must have an established responsibility to the accuser
        * must be a breach of that duty of care
        * the accused person must have either taken action or failed to take an action that violated the duty of care
    * there must be **damages** involved
        * the accuser must have suffered some type of harm, be it financial, physical, emotional, or reputational
    * there must be **causation**
        * a reasonable person must be able to conclude that the injury causes to the accuser must be a result of the breach of duty by the accused

Legal Liability
* Definition
    * _Liable_ means "responsible or answerable in law; legally obligated"
* Two forms
    * **Criminally liability**
        * occurs when a person violates a criminal law
    * **Civil liability**
        * occurs when one person claims that another person has failed to carry out a legal duty that they were responsible for.
        * Civil cases are brought to court by one party, called the **claimant**, who is accusing another party of a violation, called the **respondant**
        * Claimant may be invidividual, a corporation, or the government



Evaluation of legal risks specific to cloud computing
* Differeing legal requirements
    * State and provincial laws have different requirements for data breach notifications
* Different legal systems and frameworks in different countries
* Precendent
    * refers to the judgements in past cases and is subject to change over time with less advance notice than updates to legislation
* Conflicting Laws
    * GDPR, CLOUD ACT
* Responsibility for compliance with laws and regulations
* Researching and planning response in case of conflicting laws
* Ensuring necessary audit and IR data is logged and retained
* Any additional due diligence and due care

Legal framework and Guidelines
* **Organisation for Economic Co-operation and Development (OECD)**
    * https://www.oecd.org/
    * international organization comprised of 38 member states from around the world
    * publishes guidelines on data privacy
    * its principles are aligned with European privacy law including consent, transparency, accuracy, security, and accountability
* **Asia-Pacific Economic Cooperation Privacy Framework (APEC)**
    * https://www.apec.org/
    * Comprised of 21 member economies in the Pacific Rim
    * Incorporates many standard privacy practices into their guidance, such as preventing harm, notice, consent, security, and accountability
    * Promotes the smooth cross-border flow of information between APEC member nations
* **General Data Protection Regulation (GDPR)**
    * https://gdpr-info.eu/
    * mandates privacy for individuals, defines companies' duties to protect personal data
    * prescribes punishments for companies violating these laws
    * includes mandatory notification timelines in the event of data breach
    * GDPR formally defines many data roles related to privacy and security (subject, controller, processor)
* **Health Insurance Portability and Accountability Act (HIPAA)**
    * https://www.hhs.gov/hipaa/index.html
    * established by the US in 1996
    * regulates the privacy and control of health information data
* **Payment Card Industry Data Security Standard (PCI DSS)**
    * https://www.pcisecuritystandards.org/
    * industry standard for companies that accept, process, or recieve payment card transactions
* **Privacy Shield**
    * https://www.privacyshield.gov/welcome
    * Exists to solve the lack of an US-equivalent to GDPR, which impacts rights and obligations around data transfer
* **Sarbanes-Oxley Act (SOX)**
    * https://en.wikipedia.org/wiki/Sarbanes%E2%80%93Oxley_Act
    * law enacted in 2002
    * sets requirements for US public companies to protect financial data when stored and used

Laws and Regulations
* **Stationary Requirements**
    * required by law
    * HIPAA, GDPR, FERPA
* **Regulatory Requirements**
    * may also be required by law but refer to rules issued by a regulatory body that is appointed by a government entity
* **Contractual Requirements**
    * are required by a legal contract between private parties
    * these agreements often specify a set security controls or a compliance framework that must be implemented by a vendor
    * e.g. SOC, GAPP, CSA CCM    


eDiscovery
* Complexities/Considerartions in the Cloud
    * CSPs may not preserve essentail data for the required period of time to support historical investigations
    * they may not even log all the data relevant to support an investigation
    * shifts burden of recording/preserving potential evidence onto the consumer
* eDiscovery Frameworks
    * [NIST 8006 - Cloud Computing Forensic Science Challenges](https://csrc.nist.gov/publications/detail/nistir/8006/final)
        * Addresses common issues and solutions needed to address Digital Forensics and Incident Response (DFIR)
        * Abstract:
            * _Summarizes research performed by the members of the NIST Cloud Computing Forensic Science Working Group. Aggregates, categorizes, and discusses the forensics challenges faced by experts when responding to incidents that have occurred in a cloud-computing ecosystem._
* Forensic Data Collection Guidance
    * [ISO/IEC 27050](https://www.iso27001security.com/html/27050.html)
        * Four-part standard within the ISO/IEC 27000 family of informartion security standards
        * offers a framework, governance, and best practices for forensics, eDiscovery, and evidence management
    * [CSA Security Guidance - Domain 3: Legal Controls and eDiscovery](https://cloudsecurityalliance.org/artifacts/csa-security-guidance-domain-3-legal-issues-contracts-and-electronic-discovery/)
        * offers guidance on legal concerns related to security, privacy, and contractual obligations
* Forensic Investigation Standards
    * [ISO/IEC 27037:2012](https://www.iso.org/standard/44381.html)
        * Guide for collecting, identifying, and preserving electronic evidence
    * [ISO/IEC 27041:2015](https://www.iso.org/standard/44405.html)
        * guide for incident investigation
    * [ISO/IEC 27042:2015](https://www.iso.org/standard/44406.html)
        * Guide for digital evidence analysis
    * [ISO/IEC 27043:2015](https://www.iso.org/standard/44407.html)
        * Guide for incident investigation principles and processes

Forensics Requirements
* ISO/IEC and CSA provide guidance on best practices for collecting digital evidence and conducting forensics investigations in the cloud
* see Domain 5

## 6.2 Understand privacy issues

Difference between contractual and regulated private data (e.g., protected health information (PHI),
personally identifiable information (PII))
* **Personally Identifiable Information (PII)**
    * any information that can identify an individual (name, ssn, bdate, bplace, biometric records, etc)
    * defined by [NIST SP 800-122](https://nvlpubs.nist.gov/nistpubs/legacy/sp/nistspecialpublication800-122.pdf)
* **Protected Health Information (PHI)**
    * health-related information that can be related to a specific person
    * must be protected by strong controls and access audited
    * regulated by HIPAA/[HITRUST](https://hitrustalliance.net/)
* **Payment Data**
    * allowable storage of information related to credit and debit cards and transactions
    * applies to transction processing
    * defined and regulated by PCI DSS and is CONTRACTUAL
* Sec Team Must Understand
    * what types of data an organization is processing
    * where it is being processed
    * any associated requirements, such as contractual obligations
* legal responsibility for data privacy and protection rests with the **cloud consumer**
* the **data controller** is always responsible for ensuring that the requirements for protection and compliance are met
    * contract may include how data is processed, security controls, deletion of data, physical location, audit, and use of subcontractors


Country-specific legislation related to private data (e.g., protected health information (PHI), personally
identifiable information (PII))
* Australian Privacy Act
    * https://www.oaic.gov.au/privacy/privacy-legislation/the-privacy-act
    * introduced in 1988 by the Office of the Australian Information Commissioner (OAIC)
    * has 13 principles known as [_Australian Privacy Principles (APP)_](https://www.oaic.gov.au/privacy/australian-privacy-principles)
    * met to protect the personal information of australian residents that is transfered or processed on or off-shore
* Canadian Privacy Law
    * **Personal Information Protection and Electronic Documents Act (PIPEDA)**
        * https://www.priv.gc.ca/en/privacy-topics/privacy-laws-in-canada/the-personal-information-protection-and-electronic-documents-act-pipeda/
        * a national-level law that resitricts how commercial businesses may collect, use, and disclose personal information
        * PIPEDA covers information about an individual that is identifiable to that specific individual
            * DNA, age, medical, education, employment, identifying numbers, religion, race/ethnic orgin, financial information
        * includes a data breach notification requirement
        * PIPEDA may also be superseded by province-specific laws that are deemed substantially similar to PIPEDA
* European Union (EU)
    * **General Data Protection Regulation (GDPR)**
        * deals with the handling of data while maintaining privacy and rights of an individual
        * is international as it was created by the EU which has 27 different countries as members
        * applies to ANY company with customers in the EU
        * includes a 72-hour notification deadline in the case of data breach
        * Include the following on data subject privacy rights:
            * The right to be informed
            * The right of access
            * The right to rectification
            * The right to erasure (the right to be forgotten)
            * The rigth to restrict processing
            * The right to data portability
            * The rigth to object
            * Rights in relation to automated decision making and profilling
        * other data types in GDPR: race or ethnic origin, political affiliations or opinions, religious or philosophical beliefs, and sexual orientation
* National, Territory, and State Laws
    * **Gramm-Leach-Bliley Act (GLBA) of 1999**
        * focuses on services of banks, lenders, and insurance
        * severely limits services they can provide and the information they can share with each other
        * Consists of three main sections:
            * **The Financial Privacy Rule**
                * regulates the collection and disclosure of private financial information
            * **The Safeguards Rule**
                * stipulates that financial institutions must implement security programs to protect such information
            * **The Pretexting provisions**
                * prohibit the practice of pretexting (accessing private information using false pretenses)
    * **Privacy Shield**
        * international agreement between the US and the EU
        * allows transfer of personal data from the European Economic Area (EEA) to the US by US based companies
        * NOT an indicator of GDPR compliance
        * Organizations commit to sever principles of the agreement:
            * Notice
            * Choice
            * Security
            * Access
            * Accountability for onward transfer
            * Data integrity and purpose limitation
            * Recourse, enforcement, and liability
    * **The Stored Communication Act (SCA) of 1986**
        * create privacy protection for electronic communications like email or other digital communications stored on the internet
        * extends the Fourth Amendment of the US Constitution to the electronic realm
            * Fourth Amendment:
                * _Details the people's " right to be secure in their persons, houses, papers, and effects, against unreasonable searches and seizures"_
        * it outlines that private data is protected from authorized access or interception (by private parties or the government)
    * **Health Insurance Portability and Accountability Act (HIPAA) of 1996**
        * privacy and security regulations requiring strict security measures for hosiptals, physicians, insurance companies
        * HIPAA-covered entities are those organizations that collect or generate protected health information (PHI)
        * under HIPAA there are separate rules for privacy, security, and breach notifications, and flow of these rules down to third parties
        * under HIPAA, PHI may be stored by CSPs provided that the data is adequately protected
    * **Clarifying Lawful Overseas Use of Data (CLOUD) Act**
        * aids in evidence collection in investigation of serious crimes
        * created in 2018 due to the problems that FBI faced in forcing Microsoft to hand over data stored in Ireland
        * requires US-based companies to respond to legal requests for data no matter where the data is phyiscally located
    
Jurisdictional differences in data privacy
* Different laws and regulations may apply depending on the **location** of:
    * data subject
    * data collector
    * cloud service provider
    * subcontractors processing data
    * company headquarters of the entities involved
* **Legal concerns can**:
    * prevent the utilization of a cloud services provider
    * add to costs and time to market
    * drive changes to technical architectures required to deliver services
* Never replace compliance with convienience when evaluating services, as this increases risks

Standard privacy requirements (e.g., International Organization for Standardization/International
Electrotechnical Commission (ISO/IEC) 27018, Generally Accepted Privacy Principles (GAPP), General Data
Protection Regulation (GDPR))
* [ISO/IEC 27018](https://www.iso.org/standard/76559.html)
    * published in July 2014 as a component of the ISO 27001 standard
    * establishes commonly accepted control objectives, controls and guidelines for implementing measures to protect Personally Identifiable Information (PII) in line with the privacy principles in ISO/IEC 29100 for the public cloud computing environment.
    * adherence to these privacy requirements enables customer trust in the CSP
    * Major CSPs such as Google, Microsoft and AWS all maintain ISO 27000 compliance
    * Can provide a HIGH level of assurance
    * Concepts
        * **Consent**
            * Personal data obtained by a CSP may NOT be used for marketing purposes unless expressly permitted by the subject
        * **Control**
            * Customers shall have explicit control of their own data and how that data is used by the CSP
        * **Transparency**
            * CSPs must inform customers of where their data resides AND any subcontractors that may process personal data
        * **Communication**
            * Auditing should be in place, and any incidents should be communicated to customers
        * **Audit**
            * Companies (CSP, in this case) must subject themselves to an independent audit on an annual basis
* [Generally Accepted Privacy Principles (GAPP)](https://us.aicpa.org/interestareas/informationtechnology/privacy-management-framework)
* recently replaced with the Privacy Management Framework
* created by AICPA in 2009
* framework of privacy prinicples
* widely incorporated into the SOC 2 framework as an optional criterion
* organizations that pursue a SOC 2 audit can include these privacy controls if appropriate
* similar to ISO 27018, which is an optional extension of the controls defined in ISO 27002
* an audit of these controls results in a report that can be shared with customers or potential customers, who can use it to assess a service provider's ability to protect sensitive data.
* 10 Principles
    1. **Management**
        * the organization defines, documents, communicates, and assigns accountability for its privacy policies and procedures
    2. **Notice**
        * the origanization provides notice of its privacy policies and procedures.
        * the organization identifies the purposes for which personal information is collected, used, and retained
    3. **Choice and consent**
        * the organization describes the choices available to the individual, and secures implicit or explicit consent regarding the collection, use, and disclosure of personal data
    4. **Collection**
        * Personal information is collected only for the purposes identified in the notice provided to the individual
    5. **Use, retention, and disposal**
        * The personal information is limited to the purposes indentified in the notice the individual consented to.
    6. **Access**
        * the organization provides individuals with access to their personal information for review or update
    7. **Disclosure to third parties**
        * Personal information is disclosed to third parties only for the identified purposes and with implicit or explicit consent of the individual
    8. **Security for privacy**
        * personal information is protected against both phyiscal and logical unauthorized access
    9. **Quality**
        * the organization maintains accurate, complete, and relevant personal information that is necessary for the purposes identified
    10. **Monitoring and enforcement**
        * the organization monitors compliance with its privacy policies and procedures
        * it also has procedures in place to address privacy-related complaints and disputes

Privacy Impact Assessments (PIA)
* designed to identify the privacy data being collected, processed, or stored by a system, and assess the effects of a data beach
* several privacy laws explictly require PIAs as a planning tool for identifying and implementing required privacy controls, including GDPR and HIPAA
* conducting a PIA typically begins when a system or process is being evaluated
    * define assessment scope, data collection methods, and plan for data retention
* evolving privacy regulations often necessitates assessment of existing systems
* The [International Association of Privacy Professionals (IAPP)](https://iapp.org/) has published guides and resources related to privacy efforts, including PIA.


## 6.3 Understand audit process, methodologies, and required adaptions for a cloud environment

Auditing
* definition:
    * _a methodical examination of an environment to ensure compliance with regulations and detect abnormalities, unauthorized occurences, or outright crimes._
* serves as a primary type of detective control
* frequency is based on risk
* degree of risk also affects how often an audit is performed
* Concept of Due Care
    * Security audits and effectiveness reviews are key elements in displaying due care. Without them senior management will likely be held accountable and liable for any asset losses that occur
    * act with common sense, prudent management, responsible action
* Security audits and reviews
    * helps ensure that management programs are effective and being followed
    * commonly associated with account management practices to prevent violations with least privilege or need-to-know principles
    * can also be performed to oversee many programs and processes:
        * patch management
        * vulnerability management
        * change management
        * configuration management
* Audit Reports
    * often contain sensitive information
    * include purpose and scope of audit, and results discovered or revealed
    * may include sensitive information such as problems, standards, causes, and recommendations
    * only people with sufficient privilege SHOULD have access
* Internal Auditor
    * acts as a "trusted advisor" to the organization on risk educating stakeholders, assessing compliance
    * compliance may mean company policies or regulatory
    * some legal and regulator frameworks require the use of an independent auditor, other demand a third-party auditor
* Internal Audit
    * Can provide more continuous monitoring of control effectiveness and policy compliance
    * enables the org to catch and fix any issues before they show up on a formal audit report
    * can mitigate risk by examining cloud architectures to provide insights into an organizartion's
        * cloud governance
        * data classifications
        * IAM effectiveness
        * Regulatory compliance
        * Privacy compliance
        * Cyber threats
* Impact of Audit Requirements
    * large procedural and financial impact
    * Regulated Industries
        * some entities operate heavily regulated industries subject to numerous auditing requirements, such as banks or critical infra providers
    * Sample size and relevance
        * large environments, representative samples of some infra (20 of 100 servers) may be checked but must be representative of multi-region estate

Identify assurance challenges of virtualization and cloud
* Provider (CSP) (AWS, GCP, Azure)
    * audits of controls over the hypervisor will usually be the purview of the CSP
* Customer (Cloud consumers)
    * VMs deployed on top of that hardware are usually under ownership of the customer

Types of audit reports
* **Statement on Standards for Attestation Engagements (SSAE)**
    * https://en.wikipedia.org/wiki/SSAE_No._18
    * SSAE 18 is a set of standards defined by the AICPA (American Institute of CPAs)
    * designed to enhance the quality and usefulness of System and Organization Control (SOC) reports
    * includes audit standards and suggested report formats to guide and assit auditors
    * SOC Reports
        * SOC 1
            * deals mainly with fin controls and are used primarily by CPAs auditing fin statements
        * SOC 2 Type 1
            * report that assesses the design of security processes at a specified point in time
        * SOC 2 Type 2
            * (often written as Type II) assesses how effective those controls are over time by observing operations for at least six months
            * often requires an NDA due to sensitive contents
        * SOC 3
            * contain only the auditor's general opinions and non-sensitive data is publicly shareable
    * US-based but SOC2 has become a defacto global standard
* **International Standards on Assurance Engagments (ISAE)** 
    * https://en.wikipedia.org/wiki/ISAE_3402
    * developed and issued by the International Aduiting and Assurance Standards Board (IAASB) and published by the International Federation of Accounts (IFAC)
    * similar to the AICPA and its SSAE standards
    * the [ISAE 3402](https://isae3402.com/ISAE3402_overview.html) standard is roughly equivalent to the SOC 2 reports in the SSAE
    * defines two types of reports
        * **Type I**
            * documenting a "snapshot" of the organization's controls
        * **Type II**
            * Documenting over a period of time (typicall 12 months) show controls have been managed over time
* **Security Trust Assurance and Risk (STAR)**
    * https://cloudsecurityalliance.org/star
    * certification program driven by the Cloud Security Alliance (CSA)
    * can be used by cloud service providers, cloud customers, or adutiors and consultants
    * designed to demonstrate compliance to a desired level of assurance
    * consist of two levels of certification which provide increasing levels of assurance
        * **Level1: Self-assessment**
            * a complimentary offering that documents the security controls provided by the CSP
        * **Level 2: Third-party audit**
            * requires the CSP to engage an independent auditor to evaluate the CSPs controls against the CSA standard
            * stronger as its a 3rd party audit conducted by a trained qualified auditor


Restrictions of audit scope statements (e.g.,
Statement on Standards for Attestation
Engagements (SSAE), International Standard on
Assurance Engagements (ISAE))
* Audit Scope Statements
    * provide the reader with details on what was included in the audit and what was not
    * generally includes:
        * Statement of purpose and objectives
        * Scope of audit and explicit exclusions
        * Type of audit
        * Security assessment requirements
        * Assessments criteria and rating scales
        * Criteria for acceptance
        * Expected deliverables
        * Classification (secret, top secret, public, etc.)
    * setting params for an audit is known as _audit scope restrictions_
    * Limiting scope of audit
        * expensive endeavors
        * can affect system performance and possibly require system downtime
        * some new systems arent ready for audit
        * cost of implementing controls is too high 


Gap Analysis (e.g., control analysis, baselines)
* Definition:
    * identifies where an organization does not meet requirements and provides important information to help remediate gaps
* purpose is to compare the organization's current practices against a specified framework and identify the gaps between the two
* may be performed by either internal or external parties
* used to close gaps before a 3rd party external audit
* assess impact of changes to reg/compliance frameworks which introduce new or modified requirements
* ISO 27002 and NIST CSF are frameworks commonly used for gap analysis

Audit Planning
* Phases
    * Planning Phase
        * Activities include:
            * **Documentation and define audit program objectives**
                * collaborative internal planning of audit scope and objectives
            * **Gap analysis or readiness assessment**
                * assessing the organization's ability to successfully undergo a full audit
            * **Define audit objectives and deliverables**
                * it is important to identify the expected outputs from the audit
            * **Identifying auditors and qualifications**
                * compliance audit frameworks usually specify the type of auditor required
    * Audit Phases
        * Three major phases of an audit, which include the following activiies
            * **Audit fieldwork**
                * involves the actual work of the auditors perform to gather, test, and evaluate the organization
            * **Audit reporting**
                * report writing begins as auditors conduct their fieldwork, capturing notes and any findings
            * **Audit follow-up**
                * various activities may be conducted after the audit, including addressing any identified weaknesses

Internal Information Security Management System (ISMS)
* a systematic approach to information security
* focuses on processes, technology, and people desgined to help protect and managed an organization's information
* ISO 27001 addresses need and approaches to implementing an ISMS
* Fucntions
    * Quantify risk
    * Develop and execute risk mitigation strategies
    * Provide formal reporting on status of mitigation efforts
* Benefits
    * improve data security
    * increased organizational resilience to cyberattacks
    * Central info sec management
    * Formal risk management

Internal Information Security Controls System (ISCS)
* provides guidance for mitigating the risks identified as part of ISMS risk management processes
* several contol frameworks to choose from
    * **Scoping**
        * controls that refere to reviewing controls in the framework to identify which should apply
    * **Tailoring**
        * process of matching applicable controls with the organization's specific circumstances to which they apply
* organizations implementing an ISO 27001 ISMS will find the ISO 27002 controls very easy to use, since they are designed to fit together
* Other control frameworks
    * [NIST SP 800-53](https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final)
    * [NIST Cybersecurity Framework (CSF)](https://www.nist.gov/cyberframework)
    * [Secure Control Framework](https://securecontrolsframework.com/)
    * [CSA Cloud Control Matrix (CCM)](https://cloudsecurityalliance.org/research/cloud-controls-matrix/)

Policies (e.g., organizational, functional, cloud
computing)
* key part of any data security stragegy and facilitate a number of capabilities for an organization
* provide users and organizations with a way to understand and enforce requirements
* standard security practices throughtout the organizations
* Organizational Policies
    * companies use policies to outline rules and guidelines, usually complemented by documentation such as procedures, job aids
    * defined related to proper use of company resources like expense reimbursements and travel
    * **Policies are a proactive risk mitigation tool** desgined to reduce likelihood of risk, such as:
        * Financial loses
        * Data loss or leakage
        * Reputational damage
        * Statuary and regulatory compliance issues
        * Abuse or misuse of computing systems and resources
    * employees SHOULD generally sign policies to acknowlege accpetance
* Functional Policies
    * set of standardized definitions for employees that describe how they are to make use of systems or data
    * guide specific activites crucial to the organization, such as appropriate handling of data, vulnerability management, and so on
    * generally codify requirements identified in the ISMS and align to your chosen control framework
    * Examples:
        * **Acceptable Use**
            * what is and is not acceptable to do on company hardware and networks
        * **Email Use**
            * what is and is not acceptable to do on company email accounts
        * **Password and access management**
            * password complexity, expiration, reuse, requirements for MFA, and requirements for use of access management tools such as password manager
        * **Incident Response**
            * how incidents are handled, and requirements for defining an incident response plan
        * **Data Classification**
            * identifies types of data and how each should be classified
        * **Network services**
            * how issues such as remote access and network security are handled
        * **Vulnerability scanning**
            * routines and limitations on internal scanning and penetration testing
        * **Patch management**
            * how equipment is patched and on what schedule
* Applying policies to the Cloud
    * CASB can help identify and stop shadow IT
    * policies should define requirements users must adhere to and specify which cloud services are approved for various uses


Identification and involvement of relevant
stakeholders
* key challeng of audit process is the inclusion of any **relevant stakeholders**
* **Relevant stakeholders** are
    * management who will likely be paying for the audit
    * security practitioners responsible for facilitating the audit
    * employees who will be called upon to provide evidence to auditors in the form of documentation, artifacts, or sitting for interviews
* Cloud computing enviroments can include more stakeholders thann on-prem and even multiple CSPs

Specialized compliance requirements for
highly-regulated industries (e.g., North
American Electric Reliability Corporation /
Critical Infrastructure Protection (NERC / CIP),
Health Insurance Portability and Accountability
Act (HIPAA), Health Information Technology for
Economic and Clinical Health (HITECH) Act,
Payment Card Industry (PCI))
* **NERC/CIP**
    * https://www.nerc.com/Pages/default.aspx
    * North American Reliability Corporation (NERC) / Critical Infrastructure Protection (CIP) regulates organizations involved in power generation and distribution
* **HIPAA/HITECT**
    * https://www.hipaajournal.com/hipaa-and-hitech/
    * does not specifically address cloud computing
    * both deal with PHI and implement specific requirements for security and privacy protections, as well as breach notification requirements
* **PCI DSS**
    * specifies protections for payment card transaction data
    * no specific mention of cloud

Impact of distributed information technology
(IT) model (e.g., diverse geographical locations
and crossing over legal jurisdictions)
* Cloud computing enables distributed IT service delivery with systems that can automatically **replicate data globally**
* one impact of this distributed model is the additional geographic locations auditors must consider when performing an audit
* common technique in cloud audits is **sampling**, which is the act of picking a subset of the system's physcial infra to inpect
    * sample 20 servers of 100 servers accross many regional datacenters can save time & expense and maintain accuracy


## 6.4 Understand implications of cloud to enterprise risk management

Assess providers risk management programs (e.g., controls, methodologies, policies, risk profile,
risk appetite)
* Reviewing provider controls
    * before choosing a CSP, customer needs to analyze the risks associated with adopting that provider's services
    * rely on **supply chain risk management (SCRM)** processes instead of a full audit:
    * Primary areas of focus in SCRM are:
        * whether a supplier has a risk management program in place, and if so
        * whether the risks identified by that program are being adequately mitigated
    * SCRM in a CSP scenerio requires customer to review CSP's audit reports
    * when reviewing auditor reports there are some key elements to focus on such as scoping information or description of the audit target
    * if the CSPs SOC 2 audit did not cover a specific service a customer wants to use, then the audit finding does not provide any value!
* Methodologies
    * NIST has a resource library that includes working groups, publications, and other resources, available at https://csrc.nist.gov/Projects/cyber-supply-chain-risk-management
    * ISO 27000:2022
        * https://www.iso.org/standard/75652.html
        * specifies a security managemen system for security and resilience, with a particular focus on supply chain management
* Risk Profiles
    * describes the risk present in the organization based on all the identified risks and any associated mitigations in place
* Risk Appetite
    * describes the amount of risk an organization is willing to accept without mitigating
    * regulated industries will be more apt to mitigation, transference, and avoidance
    * smaller orgs and startups will be more apt to simply accept risks to avoid cost of treatment

Difference between data owner/controller vs. data custodian/processor
* **Data Processor**
    * anyone who processes personal data on behalf of the data controller
    * THE CUSTODIAN
    * is responsible for the safe and private custody transport, and storage
* **Data Controller**
    * the person or entity that controls processing of the data
    * THE OWNER
    * owns teh data and risks associated with any data breaches
    * when data controllers use processors, they must ensure that security requirements follow the data
* **Data Protection Officer (DPO)**
    * ensures the organization complies with data regulations
    * under GDPR, the DPO is a Manadatory appointment
* **Data Subject**
    * the individual or entity that is the subject of the personal data
* **Data Owner**
    * Data Controller in GDPR
    * usually a member of senior management
    * CAN delegate some day-to-day duties
    * CANNOT delegate total responsibility
* **Data Custodian**
    * Data Processor in GDPR
    * Usually someone in the IT department
    * DOES implement controls for data owner
    * DOES NOT decide what controls are needed

Regulatory transparency requirements (e.g., breach notification, Sarbanes-Oxley (SOX),
General Data Protection Regulation (GDPR))
* Breach Notification
    * likely manadatory
    * some variations among laws, mainly around issues of timing of the notification and who must be notified
    * regulations that require breach notification, include, but are not limited to, GDPR, HIPAA (as amended by the HITECH ACT), GLBA, PIPEDA
* Sarbanes-Oxley (SOX) Act
    * https://en.wikipedia.org/wiki/Sarbanes%E2%80%93Oxley_Act
    * if a company is publicly traded in the US, they are subject to the transparency requirements
    * User this act established in 2002, as data owners, these companies should consider the following:
        * **Section 802**
            * it is a crime to destroy, change, or hide documents to prevent their use in official legal processes
        * **Section 804**
            * companies must keep audit-related records for a minimum of five years
    * SOX compliance is often an issue with both data breaches and ransonware incidents at publicly traded companies
* General Data Protection Regulation (GDPR)
    * for companies doing business in the European Union or with citizens of the EU, transparency requirements under GDPR are laid out in [Article 12](https://gdpr-info.eu/art-12-gdpr):
        * _States that a data controller "must be able to demonstrate that personal data are processed in a manner transparent to the data subject"_
            * obligations for transparency begin at the data controller stage and apply "through the lifecylce of processing."
        * _Stipulates that communication to data subjects must be "concise, transparent, intelligible and easily accessible, and use clear and plain language."
    * meeting transparency requirements also requires processes for providing data subjects with access to their data

Risk treatment (i.e., avoid, mitigate, transfer, share, acceptance)
* Definition:
    * practice modifying risk, usually to lower it. Typically begins with identifying and assessing risks by measuring the likelihood and impact. Risks most likely to occur and impactful would be prioritized for treatment. 
    * organizations response to risk
* Methods:
    * **Risk Avoidance**
        * organization changes business practices to completely elinimate the potential that a risk will materialize
        * can negatively impact business opportunities
    * **Risk Mitigation**
        * process of applying security controls to reduce the probability and/or magnitued of a risk
    * **Risk Transference**
        * i.e. Cyber Insurance
        * shift some of the impact of a risk from the organization experiencing the risk to another entity
    * **Risk Acceptance**
        * use when cost of mitigation > cost of impact
        * deliberately choosing to take no other risk management strategy and to simply continue operations as normal in the face of the risk
* Stategies
    * **Risk Appetite**
        * also know as "risk tolerance"
        * is the amount of risk that a company is _willing to accept_
    * Regulations that affect risk posture
        * GDPR
        * SOX
        * HIPAA
        * PCI-DSS
* Security Controls
    * **safeguards**
        * proactive (reduce likelihoo of occurrence)
    * **countermeasure**
        * reactive (reduce impact after occurrence) 

Different Risk Frameworks
* [ISO 31000 - Risk Management](https://www.iso.org/iso-31000-risk-management.html)
    * [ISO 31000:2018 - Risk Management Guidelines](https://www.iso.org/standard/65694.html)
        * provides the foundation of an organization's risk management function
    * [ISO 31000:2019 - Risk Management - Risk assessment techniques](https://www.iso.org/standard/72140.html)
        * provides guidance on conducting a risk assessment
    * [ISO Guide 72:2009 - Risk Management - Vocabulary](https://www.iso.org/standard/44651.html)
        * provides a standard set of terminology used through
* NIST
    * [NIST SP 800-37](https://csrc.nist.gov/publications/detail/sp/800-37/rev-2/final)
        * Risk Management Framework
    * [NIST SP 800-146 - Cloud Computing Synopsis and Recommendations](https://csrc.nist.gov/publications/detail/sp/800-146/final)
        * provides definitions of various cloud computing terms
* European Union Agency for Cybersecurity (ENISA)
    * https://www.enisa.europa.eu/
    * rough equivalent to the US NIST
    * produces useful resources related to cloud-specific risks that organizations should be aware of and plan for when designing cloud computing systems
    * guide identifies various categories of risk and recommendations for organizations to consider when evaluating cloud computing
    * includes research recommendations to advance the field of cloud computing, legal risks, and security risks

Metrics for risk management
* key metrics
    * **Patching levels**
        * how many devices are fully patched and up-to-date?
        * unpatched devices often contain exploitable vulnerabilities
    * **Time to deploy patches**
        * how may devices receive required patches in the defined timeframes?
        * useful measure of how effective a patch management program is at reducing the risk of known vulnerabilities
    * **Instrusion attempts**
        * how many times have unknown actors tried to breach cloud systems?
        * increased intrusion attempts can be an indicator of increased risk likelihood
    * **Mean time to detect (MTTD)**
        * how long does it take for sec teams to become aware of a potential sec incident
    * **Mean time to contain (MTTC)**
        * how long does it take for sec teams to take action and contain the damage after a sec incident
    * **Mean time to resolve (MTTR)**
        * how long does it take for sec teams to resolve the sec incident

Assessment of risk environment (e.g., service, vendor, infrastructure, business)
* Questions to ask when considering a cloud service, vendor or infra provider
    * Is the provider subject to takeover or acquisition?
    * How financially stable is the provider?
    * In what legal jurisdiction(s) are the provider's offices located?
    * Are there outstanding lawsuits against the provdier?
    * What pricing protections are in place for services contracted?
    * How will a provider satisfy any regulatory or legal compliance requirements?
    * What does failover, backup, and recovery look like for the provider?
* **Common Criteria (ISO/IEC 15408-1)**
    * https://www.iso.org/standard/72891.html
    * Enables an objective evaluation to validate that a particular product or system statisfies a defined set of security requirements
    * Assures customers that security products they purchase have been thoroughly tested by independent third-party testers and meets customer requirements
    * certification of the product only certifies product capabilities
    * evaluation is done through testing laboratories where the product/platform is evaluated against a standard set of criteria
    * the result is an [Evaluation Assurance Level (EAL)](https://en.wikipedia.org/wiki/Evaluation_Assurance_Level), which defines how robust the security capabilities are in the evaluated product
* CSA STAR (Security, Trust, Assurance, Risk)
    * https://cloudsecurityalliance.org/star/
    * lightweight method
    * contains evaluation of cloud services against the CSA's Cloud Control Matrix (CCM)
    * Organizations can opt for self-assessment or third-party assessed
* EU Cybersecurity Certification Scheme on Cloud Services (EUCS)
    * https://www.enisa.europa.eu/publications/eucs-cloud-service-scheme
    * standard published by ENISA for certifying the cybersecurity practices present in cloud environments
    * framework defines a set of evaluation criteria for various cloud service and deployment models
    * goal is producing security evaluation results that allow comparison of security posture across different cloud providers
    * Standard was still in development as of 2022, and is not yet widespread


## 6.5 Understand outsourcing and cloud contract design

Business requirements (e.g., service-level agreement (SLA), master service agreement (MSA),
statement of work (SOW))
* **Master Service Agreement (MSA)**
    * defined as any contract that two or more parties enter into a service agreement
    * should address compliance and process requirements the customer is passing along to the CSP
    * should include breach notification (CSP duty)
* **Service-Level Agreements (SLA)**
    * Stipulates performance expectations such as maximum downtimes and often include penalties if the vendor doesn't meet expectations
    * generally used with external vendors (like CSP) and is legally binding
    * often includes financial penalties for non-performance, amy allow customer to terminate a contract
    * Common elements in SLAs:
        * Uptime guarantees
        * SLA violation penalties
        * SLA violation penalty exclusions and limitations
        * Suspension of service clauses
        * Provider liability
        * Data protection and management
        * Disaster recovery and recovery point objectives
        * Security and privacy notifications and timeframes
* **Statement of Work (SOW)**
    * legal document created after an MSA has been executed and governs a specific unit of work
    * MSA may document services and prices, a SOW covers requirements, expectations, and deliverables for a project.
* **Non-Discolsure Agreement (NDA)**
    * contract with vendors and suppliers not to disclose the company's confidential information

Vendor management (e.g., vendor assessments, vendor lock-in risks, vendor viability, escrow)
* SCRM and vendor management overlap
* vendor management will include more activities related to operational risks
* **Asses vendors**
    * sec practitioners should participate in the inital selection process for a csp to assess sec risks
    * review soc 2 reports
* **Assess vendor lock-in risks**
    * requires knowledge of not only the CSPs offerings but the architecture and strategy the customer organization intends to use
    * using unique CSP offerings, such AI/ML platforms, can result in a service that is dependent on that specific CSP
* **Assess venord viability**
    * process that is not conducted by sec team
    * involves reviews of public info like:
        * financial statements
        * CSPs performance history and reputation
        * review SOC 1 report
* **Escrow**
    * legal term used then a trusted third party holds something on behalf of two or more other parties, such as souce code or encryption keys

Contract management (e.g., right to audit, metrics, definitions, termination, litigation, assurance,
compliance, access to cloud/data, cyber risk insurance)
* organizations must employ adequate governance structures to **monitor contract terms and performance** and **be aware of outages** and **any violations of stated agreements**
* **Contract Clauses**
    * specific article of related information that specifies the agreement between the contracting parties
    * some common contract clauses that should be considered for any CSP or other data service provider include the follwing:
        * Right to audit
            * customer can request the right to audit the service provider to ensure compliance with sec reqs that are agreed to in the contract
            * contracts often written to allow CSPs standard audits (SOC2, ISO 27001 cert) to be used in place of a customer-performed audit
        * Metrics
            * specific indicators that the SP must provide to the customer, the should be documented
        * Definitions
            * common understanding of the terms and expectations
        * Termination
            * refers to ending the contractual agreement
            * typically define conditions under which either party may terminate the contract
        * Litigation
            * legal counsel must be consulted
            * agreeing to terms for litigation can severly restrict organizations ability to pursue damages if something goes wrong
        * Assurance
            * Defining assurance requirements sets expectations for both provider and customer
        * Compliance
            * compliance requirements that flow to the provider must be documented and agreed upon in the contract
            * data controllers that use cloud providers as data processors must ensure that adequate security safeguards are available for that data
        * Access to cloud/data
            * clauses dealing with customer access can be used to avoid risks associated with vendor lock-in
    * Cyber Risk Insurance
        * designed to help an organziation reduce the financial impact of risk by tranferring it to an insurance carrier
        * in the event of a security incident, the insurance carrier can help offset associated costs, such as digital forensics and investigation, data recovery, system restoration
        * may cover legal or reg fines
        * orgs pay a premium for the insurance plan
        * have a limit of cover that caps how much the insurance carrier pays
        * may also be sub-limits, which cap the amount that will be paid for specific types of incidents such as ransomware or phishing
        * an insurance broker can be useful resource when investigating insurance options for your organization's circumstances, including
            * the amount of coverage needed
            * different types of coverage such as business interruption or cyber extortion
            * security controls that insurance carrier requires, such as MFA
        * usually covers cost associated with the following:
            * Investigation
                * costs associated with the forensic investigation to determine the extent of an incident
                * cost for 3rd party investigators
            * Direct business losses
                * monetary losses associated with downtime or data recovery, overtime for employees, and oftentimes, reputational damages to the organization
            * Recovery costs
                * may include costs associated with replacing hardward or provisioning temporary cloud environments during contingency operations
                * may also include services like forensic data recovery or negotiations with attackers to assist in recovery
            * Legal notifications
                * costs associated with required privacy and breach notifications required by relevant laws
            * Lawsuits
                * policies written to coveer losses and payouts due to class action or other lawsuits against a company after a cyber incident
            * Extortion
                * costs associate with payouts to for ransomware demands
            * Food and related expenses
                * associated costs for employees working overtime or extended hours/travel to contigency sites
                * catering and lodging 

Supply-chain management (e.g., International Organization for Standardization/International
Electrotechnical Commission (ISO/IEC) 27036)
* focuses on both Operational Risks, to ensure that suppliers are capable of providing the needed services and security risks
* [ISO/IEC 27036 - 1:2021 - Cybersecurity - Supplier relationships](https://www.iso.org/standard/82905.html)
    * provides a set of practices and guidance for managing cybersecurity risks in supplier relationships
    * the standard is particularly useful for organizations that use ISO 27001 for building an ISMS or ISO 31000 for risk management
    * builds on concepts found in those standards
    * comprises four parts:
        * **Part 1 - Overview and concepts**
            * provides an overview and foundation for a supply chain management capability
        * **Part 2 - Requirements**
            * provides a set of best practices and techniques for designing and implementing the supply chain management fucntion
        * **Part 3 - Guidelines for information and communication technology supply chain security**
            * lays out practices and techniques specific to managing security risks in the supply chain
        * **Part 4 - Guidelines for security of cloud services**
            * deals with practices and requirements for managing supply chain security risk specific to cloud computing and CSP
* Additional Resources
    * [NISTIR 8276](https://csrc.nist.gov/News/2021/nistir-8276-key-practices-in-c-scrm)
    * [NIST SP 800-161](https://csrc.nist.gov/publications/detail/sp/800-161/rev-1/final)
    * [ENISA publication Supply Chain Integrity](https://www.enisa.europa.eu/publications/sci-2015/at_download/fullReport)

